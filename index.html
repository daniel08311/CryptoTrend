<!DOCTYPE html>
<html>
<head>
	<title>test</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
</head>
<body>

	<script src="/socket.io/socket.io.js"></script>
 	<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<script src="js/echarts.common.js"></script>
	<script>
		var socket = io.connect(); 

		socket.on('exchange', function(message){
		var html = "";
		var Categories = ['Bullish','Weak Bullish','Neutral','Weak Bearish','Bearish'];
		var Markets = [];
		var Series = {};
		Series['bull'] = [];
		Series['wbull'] = [];
		Series['wbear'] = [];
		Series['bear'] = [];
		Series['neutral'] = [];
	  	for(var i = 0; i < message.test.length; i++){
			Markets.push(message.test[i]['name'])
			Series['bull'].push(message.test[i]['bull']);
			Series['wbull'].push(message.test[i]['wbull']);
			Series['bear'].push(message.test[i]['bear']);
			Series['wbear'].push(message.test[i]['wbear']);
			Series['neutral'].push(message.test[i]['n']);

	  		html += "<div class='col-sm-2'><h3>" + message.test[i]['name'] + " :</h3>";
			html += "<div> Strong Bull : " + message.test[i]['bull'];
			html += "</div><div> Weak Bull : " + message.test[i]['wbull'];	
			html += "</div><div> Weak Bear : " + message.test[i]['wbear'];	
			html += "</div><div> Strong Bear : " + message.test[i]['bear'];
			html += "</div><div> Neutral : " + message.test[i]['n'] + "</div></div>";			
		}
	  	html+="</div>";
		// document.getElementById('data').innerHTML = html;
		var myChart = echarts.init(document.getElementById('main'));
        // 指定图表的配置项和数据
        var option = {
			tooltip : {
				trigger: 'axis',
				axisPointer : {            // 坐标轴指示器，坐标轴触发有效
					type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
				}
			},
			legend: {
				data: Categories
			},
			grid: {
				left: '3%',
				right: '4%',
				bottom: '3%',
				containLabel: true
			},
			xAxis:  {
				type: 'value'
			},
			yAxis: {
				type: 'category',
				data: Markets
			},
			series: [
				{
					name: 'Bullish',
					type: 'bar',
					color: '#00cc33',
					stack: '总量',
					label: {
						normal: {
							show: true,
							position: 'insideRight'
						}
					},
					data: Series['bull']
				},
				{
					name: 'Weak Bullish',
					type: 'bar',
					stack: '总量',
					label: {
						normal: {
							show: true,
							position: 'insideRight'
						}
					},
					data: Series['wbull']
				},
				{
					name: 'Neutral',
					type: 'bar',
					stack: '总量',
					label: {
						normal: {
							show: true,
							position: 'insideRight'
						}
					},
					data: Series['neutral']
				},
				{
					name: 'Weak Bearish',
					type: 'bar',
					stack: '总量',
					label: {
						normal: {
							show: true,
							position: 'insideRight'
						}
					},
					data: Series['wbear']
				},
				{
					name: 'Bearish',
					type: 'bar',
					stack: '总量',
					label: {
						normal: {
							show: true,
							position: 'insideRight'
						}
					},
					data: Series['bear']
				}
			]
		};
        // 使用刚指定的配置项和数据显示图表。
		myChart.setOption(option);
	  });
	  // socket.on('data', function(message) {
	  // 	var html = "";
	  //   document.getElementById('data').innerHTML = "BULL : " + message.test["bull"];
	  // })
	</script>
	<div class="row justify-content-md-center my-4" id="data">
	</div>
	<div class='row justify-content-md-center my-4'>
		<div class='col-md-6' id="main" style="width: 600px;height:400px;">
		</div>
	</div>
	
</body>
</html>
